{"version":3,"sources":["webpack:///src/app/verification/verification.page.html","webpack:///src/app/verification/verification-routing.module.ts","webpack:///src/app/verification/verification.module.ts","webpack:///src/app/verification/verification.page.scss","webpack:///src/app/verification/verification.page.ts"],"names":["routes","path","component","VerificationPageRoutingModule","imports","forChild","exports","VerificationPageModule","declarations","VerificationPage","route","uiElementService","myEvent","platform","apiService","translate","navCtrl","captchanotvarified","buttonDisabled","captchaVerified","minutes","seconds","totalSeconds","intervalCalled","resendCode","otpNotSent","otp","queryParams","subscribe","params","phoneNumberFull","is","makeCaptcha","sendOTP","token","get","value","presentLoading","loginUser","role","ROLE_USER","res","dismissLoading","setLoggedInUserResponse","setupHeaders","setUserMeData","user","window","localStorage","removeItem","KEY_ADDRESS","setAddressData","navigateForward","err","console","log","presentErrorAlert","error","message","String","toLowerCase","includes","getIdToken","then","sendOtpPhone","sendOtpBrowser","clearInterval","timer","createTimer","setInterval","phone","FirebasePlugin","verifyPhoneNumber","credential","JSON","stringify","instantVerification","presentToast","verifyOtpPhone","createInterval","text","signInWithPhoneNumber","recaptchaVerifier","confirmationResult","result","code","verifyOtpBrowser","signInAndRetrieveDataWithCredential","info","getUserToken","signInWithCredential","getCurrentUser","idToken","retryOld","PhoneAuthProvider","id","confirm","response","RecaptchaVerifier","render","selector","template"],"mappings":"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","file":"verification-verification-module-es5.js","sourcesContent":["export default \"<ion-header>\\r\\n\\t<ion-toolbar>\\r\\n\\t\\t<ion-buttons slot=\\\"start\\\">\\r\\n\\t\\t\\t<ion-back-button text=\\\"\\\" icon=\\\"chevron-back-outline\\\"></ion-back-button>\\r\\n\\t\\t</ion-buttons>\\r\\n\\t\\t<ion-title>{{'phone_verification' | translate}}</ion-title>\\r\\n\\t</ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content>\\r\\n\\t<div id=\\\"recaptcha-container\\\"></div>\\r\\n\\t<div class=\\\"form\\\">\\r\\n\\t\\t<p class=\\\"ion-text-center\\\">{{'verification_text' | translate}} {{phoneNumberFull}} </p>\\r\\n\\r\\n\\t\\t<ion-list lines=\\\"none\\\">\\r\\n\\t\\t\\t<ion-item lines=\\\"none\\\">\\r\\n\\t\\t\\t\\t<ion-input class=\\\"ion-text-center\\\" type=\\\"number\\\" [(ngModel)]=\\\"otp\\\"\\r\\n\\t\\t\\t\\t\\tplaceholder=\\\"{{'enter_verification_code' | translate}}\\\">\\r\\n\\t\\t\\t\\t</ion-input>\\r\\n\\t\\t\\t</ion-item>\\r\\n\\r\\n\\t\\t\\t<ion-button size=\\\"large\\\" shape=\\\"block\\\" class=\\\"btn\\\" (click)=\\\"verify()\\\">\\r\\n\\t\\t\\t\\t{{'verify' | translate}}\\r\\n\\t\\t\\t</ion-button>\\r\\n\\t\\t</ion-list>\\r\\n\\t\\t<!-- <h4 class=\\\"d-flex\\\">0:22 min left <span class=\\\"end\\\">{{'resend' | translate}}</span></h4> -->\\r\\n\\t</div>\\r\\n</ion-content>\";","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { VerificationPage } from './verification.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: VerificationPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class VerificationPageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { VerificationPageRoutingModule } from './verification-routing.module';\r\n\r\nimport { VerificationPage } from './verification.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    TranslateModule,\r\n    VerificationPageRoutingModule\r\n  ],\r\n  declarations: [VerificationPage]\r\n})\r\nexport class VerificationPageModule { }\r\n","export default \"ion-header ion-toolbar ion-title {\\n  position: absolute !important;\\n  left: 0;\\n  top: 0;\\n  width: 100%;\\n  text-align: center;\\n  padding: 0 15px !important;\\n}\\n\\n.form {\\n  padding-top: 50px;\\n}\\n\\n.form p {\\n  color: var(--text-light) !important;\\n  margin: 0;\\n  font-size: 1rem !important;\\n  letter-spacing: 0;\\n  font-weight: 500;\\n  line-height: 19px;\\n  margin-bottom: 50px;\\n  opacity: 0.8;\\n}\\n\\n.form .button.btn.button-block {\\n  margin-top: 25px;\\n}\\n\\n.form ion-list {\\n  margin-bottom: 28px;\\n}\\n\\n.form h4 {\\n  margin: 0;\\n  font-size: 0.95rem;\\n  font-weight: 500;\\n}\\n\\n.form h4 span {\\n  text-transform: uppercase;\\n  font-size: 0.95rem;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvdmVyaWZpY2F0aW9uL0Y6XFxmaXZlclxcQmVybmFyZFxcQWdvY2FycnlcXGFnb2NhcnJ5LWN1c3RvbWVyL3NyY1xcYXBwXFx2ZXJpZmljYXRpb25cXHZlcmlmaWNhdGlvbi5wYWdlLnNjc3MiLCJzcmMvYXBwL3ZlcmlmaWNhdGlvbi92ZXJpZmljYXRpb24ucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0MsNkJBQUE7RUFDQSxPQUFBO0VBQ0EsTUFBQTtFQUNBLFdBQUE7RUFDQSxrQkFBQTtFQUNBLDBCQUFBO0FDQ0Q7O0FERUE7RUFDQyxpQkFBQTtBQ0NEOztBRENDO0VBQ0MsbUNBQUE7RUFDQSxTQUFBO0VBQ0EsMEJBQUE7RUFDQSxpQkFBQTtFQUNBLGdCQUFBO0VBQ0EsaUJBQUE7RUFDQSxtQkFBQTtFQUNBLFlBQUE7QUNDRjs7QURFQztFQUNDLGdCQUFBO0FDQUY7O0FER0M7RUFDQyxtQkFBQTtBQ0RGOztBRElDO0VBQ0MsU0FBQTtFQUNBLGtCQUFBO0VBQ0EsZ0JBQUE7QUNGRjs7QURHUTtFQUNJLHlCQUFBO0VBQ1Isa0JBQUE7QUNESiIsImZpbGUiOiJzcmMvYXBwL3ZlcmlmaWNhdGlvbi92ZXJpZmljYXRpb24ucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiaW9uLWhlYWRlciBpb24tdG9vbGJhciBpb24tdGl0bGUge1xyXG5cdHBvc2l0aW9uOiBhYnNvbHV0ZSAhaW1wb3J0YW50O1xyXG5cdGxlZnQ6IDA7XHJcblx0dG9wOiAwO1xyXG5cdHdpZHRoOiAxMDAlO1xyXG5cdHRleHQtYWxpZ246IGNlbnRlcjtcclxuXHRwYWRkaW5nOiAwIDE1cHggIWltcG9ydGFudDtcclxufVxyXG5cclxuLmZvcm0ge1xyXG5cdHBhZGRpbmctdG9wOiA1MHB4O1xyXG5cclxuXHRwIHtcclxuXHRcdGNvbG9yOiB2YXIoLS10ZXh0LWxpZ2h0KSAhaW1wb3J0YW50O1xyXG5cdFx0bWFyZ2luOiAwO1xyXG5cdFx0Zm9udC1zaXplOiAxcmVtICFpbXBvcnRhbnQ7XHJcblx0XHRsZXR0ZXItc3BhY2luZzogMDtcclxuXHRcdGZvbnQtd2VpZ2h0OiA1MDA7XHJcblx0XHRsaW5lLWhlaWdodDogMTlweDtcclxuXHRcdG1hcmdpbi1ib3R0b206IDUwcHg7XHJcblx0XHRvcGFjaXR5OiAuODtcclxuXHR9XHJcblxyXG5cdC5idXR0b24uYnRuLmJ1dHRvbi1ibG9jayB7XHJcblx0XHRtYXJnaW4tdG9wOiAyNXB4O1xyXG5cdH1cclxuXHJcblx0aW9uLWxpc3Qge1xyXG5cdFx0bWFyZ2luLWJvdHRvbTogMjhweDtcclxuXHR9XHJcblxyXG5cdGg0IHtcclxuXHRcdG1hcmdpbjogMDtcclxuXHRcdGZvbnQtc2l6ZTogLjk1cmVtO1xyXG5cdFx0Zm9udC13ZWlnaHQ6IDUwMDtcclxuICAgICAgICBzcGFue1xyXG4gICAgICAgICAgICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlO1xyXG4gICAgZm9udC1zaXplOiAuOTVyZW07IFxyXG4gICAgICAgIH1cclxuXHR9XHJcbn1cclxuIiwiaW9uLWhlYWRlciBpb24tdG9vbGJhciBpb24tdGl0bGUge1xuICBwb3NpdGlvbjogYWJzb2x1dGUgIWltcG9ydGFudDtcbiAgbGVmdDogMDtcbiAgdG9wOiAwO1xuICB3aWR0aDogMTAwJTtcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xuICBwYWRkaW5nOiAwIDE1cHggIWltcG9ydGFudDtcbn1cblxuLmZvcm0ge1xuICBwYWRkaW5nLXRvcDogNTBweDtcbn1cbi5mb3JtIHAge1xuICBjb2xvcjogdmFyKC0tdGV4dC1saWdodCkgIWltcG9ydGFudDtcbiAgbWFyZ2luOiAwO1xuICBmb250LXNpemU6IDFyZW0gIWltcG9ydGFudDtcbiAgbGV0dGVyLXNwYWNpbmc6IDA7XG4gIGZvbnQtd2VpZ2h0OiA1MDA7XG4gIGxpbmUtaGVpZ2h0OiAxOXB4O1xuICBtYXJnaW4tYm90dG9tOiA1MHB4O1xuICBvcGFjaXR5OiAwLjg7XG59XG4uZm9ybSAuYnV0dG9uLmJ0bi5idXR0b24tYmxvY2sge1xuICBtYXJnaW4tdG9wOiAyNXB4O1xufVxuLmZvcm0gaW9uLWxpc3Qge1xuICBtYXJnaW4tYm90dG9tOiAyOHB4O1xufVxuLmZvcm0gaDQge1xuICBtYXJnaW46IDA7XG4gIGZvbnQtc2l6ZTogMC45NXJlbTtcbiAgZm9udC13ZWlnaHQ6IDUwMDtcbn1cbi5mb3JtIGg0IHNwYW4ge1xuICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlO1xuICBmb250LXNpemU6IDAuOTVyZW07XG59Il19 */\";","import { Component, OnInit } from '@angular/core';\r\nimport { NavController, Platform } from '@ionic/angular'\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { UiElementsService } from '../services/common/ui-elements.service';\r\nimport { MyEventsService } from '../services/events/my-events.service';\r\nimport { ApiService } from '../services/network/api.service';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { Helper } from 'src/models/helper.models';\r\nimport * as firebase from 'firebase/app';\r\nimport { Constants } from 'src/models/constants.models';\r\n\r\n@Component({\r\n  selector: 'app-verification',\r\n  templateUrl: './verification.page.html',\r\n  styleUrls: ['./verification.page.scss']\r\n})\r\nexport class VerificationPage implements OnInit {\r\n  private recaptchaVerifier: firebase.auth.RecaptchaVerifier;\r\n  private captchanotvarified: boolean = true;\r\n  private result: any;\r\n  private buttonDisabled: any = true;\r\n  private component: any;\r\n  private captchaVerified: boolean = false;\r\n  private verfificationId: any;\r\n  private timer: any;\r\n  private minutes: number = 0;\r\n  private seconds: number = 0;\r\n  private totalSeconds: number = 0;\r\n  private intervalCalled: boolean = false;\r\n  private dialCode: string;\r\n  private resendCode: boolean = false;\r\n  private otpNotSent: boolean = true;\r\n  private credential: any;\r\n\r\n  phoneNumberFull: string;\r\n  otp = \"\";\r\n\r\n  constructor(private route: ActivatedRoute, private uiElementService: UiElementsService, private myEvent: MyEventsService,\r\n    private platform: Platform, private apiService: ApiService, private translate: TranslateService, private navCtrl:NavController) { }\r\n\r\n  ngOnInit() {\r\n    this.route.queryParams.subscribe(params => this.phoneNumberFull = params[\"phoneNumberFull\"]);\r\n    \r\n    if (!(this.platform.is('cordova'))) {\r\n      this.makeCaptcha();\r\n    }\r\n    this.sendOTP();\r\n  }\r\n\r\n  loginUser(token) {\r\n    this.translate.get('just_moment').subscribe(value => {\r\n      this.uiElementService.presentLoading(value);\r\n\r\n      this.apiService.loginUser({ token: token, role: Constants.ROLE_USER }).subscribe(res => {\r\n        this.uiElementService.dismissLoading();\r\n        Helper.setLoggedInUserResponse(res);\r\n        this.apiService.setupHeaders(res.token);\r\n        this.myEvent.setUserMeData(res.user);\r\n        window.localStorage.removeItem(Constants.KEY_ADDRESS);\r\n        this.myEvent.setAddressData(null);\r\n        this.navCtrl.navigateForward(['tabs/main-home']);    \r\n      }, err => {\r\n        console.log(err);\r\n        this.uiElementService.dismissLoading();\r\n        this.uiElementService.presentErrorAlert((err && err.error && err.error.message && String(err.error.message).toLowerCase().includes(\"role\")) ? \"User exists with different role\" : \"Something went wrong\");\r\n      });\r\n    });\r\n  }\r\n\r\n  getUserToken(user) {\r\n    user.getIdToken(false).then(res => {\r\n      console.log('user_token_success', res);\r\n      this.loginUser(res);\r\n    }).catch(err => {\r\n      console.log('user_token_failure', err);\r\n    });\r\n  }\r\n\r\n  sendOTP() {\r\n    this.resendCode = false;\r\n    this.otpNotSent = true;\r\n    if (this.platform.is('cordova')) {\r\n      this.sendOtpPhone(this.phoneNumberFull);\r\n    } else {\r\n      this.sendOtpBrowser(this.phoneNumberFull);\r\n    }\r\n    if (this.intervalCalled) {\r\n      clearInterval(this.timer);\r\n    }\r\n  }\r\n\r\n  createTimer() {\r\n    this.intervalCalled = true;\r\n    this.totalSeconds--;\r\n    if (this.totalSeconds == 0) {\r\n      this.otpNotSent = true;\r\n      this.resendCode = true;\r\n      clearInterval(this.timer);\r\n    } else {\r\n      this.seconds = (this.totalSeconds % 60);\r\n      if (this.totalSeconds >= this.seconds) {\r\n        this.minutes = (this.totalSeconds - this.seconds) / 60\r\n      } else {\r\n        this.minutes = 0;\r\n      }\r\n    }\r\n  }\r\n\r\n  createInterval() {\r\n    this.totalSeconds = 120;\r\n    this.createTimer();\r\n    this.timer = setInterval(() => {\r\n      this.createTimer();\r\n    }, 1000);\r\n  }\r\n\r\n  sendOtpPhone(phone) {\r\n    const component = this;\r\n    this.translate.get('sending_otp').subscribe(value => {\r\n      this.uiElementService.presentLoading(value);\r\n\r\n      (<any>window).FirebasePlugin.verifyPhoneNumber(function (credential) {\r\n        component.uiElementService.dismissLoading();\r\n        console.log(\"verifyPhoneNumber\", JSON.stringify(credential));\r\n        //component.verfificationId = credential.instantVerification ? credential.id : credential.verificationId;\r\n        component.credential = credential;\r\n        if (credential.instantVerification) {\r\n          component.translate.get(\"verifying_otp_auto\").subscribe(value => component.uiElementService.presentToast(value));\r\n          component.verifyOtpPhone();\r\n        } else {\r\n          component.translate.get(\"sending_otp_success\").subscribe(value => component.uiElementService.presentToast(value));\r\n          component.otpNotSent = false;\r\n          component.createInterval();\r\n        }\r\n        // component.translate.get(\"otp_sent\").subscribe(value => {\r\n        //   component.global.showToast(value);\r\n        // });\r\n        // component.otpNotSent = false;\r\n        // component.createInterval(); \r\n      }, function (error) {\r\n        console.log(\"otp_send_fail\", error);\r\n        component.otpNotSent = true;\r\n        component.resendCode = true;\r\n        component.uiElementService.dismissLoading();\r\n        component.translate.get('sending_otp_fail').subscribe(text => component.uiElementService.presentToast(text));\r\n      }, phone, 60);\r\n    });\r\n  }\r\n\r\n  sendOtpBrowser(phone) {\r\n    const component = this;\r\n    this.uiElementService.dismissLoading();\r\n    this.uiElementService.presentLoading(\"Sending otp\");\r\n    firebase.auth().signInWithPhoneNumber(phone, this.recaptchaVerifier).then((confirmationResult) => {\r\n      console.log(\"otp_send_success\", confirmationResult);\r\n      component.otpNotSent = false;\r\n      component.result = confirmationResult;\r\n      component.uiElementService.dismissLoading();\r\n      component.uiElementService.presentToast(\"OTP Sent\");\r\n      if (component.intervalCalled) {\r\n        clearInterval(component.timer);\r\n      }\r\n      component.createInterval();\r\n    }).catch(function (error) {\r\n      console.log(\"otp_send_fail\", error);\r\n      component.resendCode = true;\r\n      component.uiElementService.dismissLoading();\r\n      if (error.message) {\r\n        component.uiElementService.presentToast(error.message);\r\n      } else {\r\n        component.uiElementService.presentToast(\"OTP Sending failed\");\r\n      }\r\n    });\r\n  }\r\n\r\n  verify() {\r\n    this.otpNotSent = true;\r\n    if (this.platform.is('cordova')) {\r\n      this.credential.code = String(this.otp);\r\n      this.verifyOtpPhone();\r\n    } else {\r\n      this.verifyOtpBrowser();\r\n    }\r\n  }\r\n\r\n  retryOld(credential) {\r\n    //const credential = firebase.auth.PhoneAuthProvider.credential(this.verfificationId, this.otp);\r\n    this.translate.get('verifying_otp').subscribe(value => {\r\n      this.uiElementService.presentLoading(value);\r\n\r\n      firebase.auth().signInAndRetrieveDataWithCredential(credential).then((info) => {\r\n        console.log('otp_verify_success', info);\r\n        this.uiElementService.dismissLoading();\r\n        this.translate.get('verifying_otp_success').subscribe(value => this.uiElementService.presentToast(value));\r\n        this.getUserToken(info.user);\r\n      }, (error) => {\r\n        console.log('otp_verify_fail', error);\r\n        this.translate.get('verifying_otp_fail').subscribe(value => this.uiElementService.presentToast(value));\r\n        this.uiElementService.dismissLoading();\r\n      })\r\n    });\r\n  }\r\n\r\n  verifyOtpPhone() {\r\n    const component = this;\r\n    this.translate.get('verifying_otp').subscribe(text => {\r\n      this.uiElementService.presentLoading(text);\r\n      console.log(\"credential\", component.credential);\r\n      (<any>window).FirebasePlugin.signInWithCredential(component.credential, function () {\r\n        console.log(\"signInWithCredential\");\r\n        (<any>window).FirebasePlugin.getCurrentUser(function (user) {\r\n          component.uiElementService.dismissLoading();\r\n          console.log(\"getCurrentUser\", JSON.stringify(user));\r\n          component.translate.get('otp_verified').subscribe(text => component.uiElementService.presentToast(text));\r\n          component.loginUser(user.idToken);\r\n        }, function (error) {\r\n          component.uiElementService.dismissLoading();\r\n          console.log(\"getCurrentUser\", JSON.stringify(error));\r\n          component.translate.get('verify_otp_err').subscribe(text => component.uiElementService.presentToast(text));\r\n        });\r\n      }, function (error) {\r\n        console.error(\"signInWithCredential\", error);\r\n        component.uiElementService.dismissLoading();\r\n        component.retryOld(firebase.auth.PhoneAuthProvider.credential(component.credential.id, component.otp));\r\n        component.translate.get('verify_otp_err').subscribe(text => component.uiElementService.presentToast(text));\r\n      });\r\n    });\r\n  }\r\n\r\n  verifyOtpBrowser() {\r\n    const component = this;\r\n    this.uiElementService.presentLoading(\"Verifying otp\");\r\n    this.result.confirm(String(this.otp)).then(function (response) {\r\n      console.log('otp_verify_success', response);\r\n      component.uiElementService.dismissLoading();\r\n      component.uiElementService.presentToast(\"OTP Verified\");\r\n      component.getUserToken(response.user);\r\n    }).catch(function (error) {\r\n      console.log('otp_verify_fail', error);\r\n      if (error.message) {\r\n        component.uiElementService.presentToast(error.message);\r\n      } else {\r\n        component.uiElementService.presentToast(\"OTP Verification failed\");\r\n      }\r\n      component.uiElementService.dismissLoading();\r\n    });\r\n  }\r\n\r\n  makeCaptcha() {\r\n    const component = this;\r\n    this.recaptchaVerifier = new firebase.auth.RecaptchaVerifier('recaptcha-container', {\r\n      // 'size': 'normal',\r\n      'size': 'invisible',\r\n      'callback': function (response) {\r\n        component.captchanotvarified = true;\r\n        // reCAPTCHA solved, allow signInWithPhoneNumber.\r\n      }\r\n    });\r\n    this.recaptchaVerifier.render();\r\n  }\r\n\r\n}\r\n"]}